WITH raw_credithistory AS (
    SELECT
        *
    FROM {{ source('raw_data', 'credithistory') }}
)

SELECT
    _AIRBYTE_RAW_ID::VARCHAR(36)            AS _AIRBYTE_RAW_ID,
    _AIRBYTE_EXTRACTED_AT::TIMESTAMP_TZ     AS _AIRBYTE_EXTRACTED_AT,
    _AIRBYTE_META::VARIANT                  AS _AIRBYTE_META,
    INQ_FI::NUMBER                          AS INQ_FI,
    BC_UTIL::NUMBER(10,2)                   AS BC_UTIL,
    IL_UTIL::NUMBER(10,2)                   AS IL_UTIL,
    PUB_REC::NUMBER                         AS PUB_REC,
    ALL_UTIL::NUMBER(10,2)                  AS ALL_UTIL,
    MORT_ACC::NUMBER                        AS MORT_ACC,
    NUM_SATS::NUMBER                        AS NUM_SATS,
    OPEN_ACC::NUMBER                        AS OPEN_ACC,
    NUM_BC_TL::NUMBER                       AS NUM_BC_TL,
    NUM_IL_TL::NUMBER                       AS NUM_IL_TL,
    REVOL_BAL::NUMBER(18,2)                 AS REVOL_BAL,
    TAX_LIENS::NUMBER                       AS TAX_LIENS,
    TOTAL_ACC::NUMBER                       AS TOTAL_ACC,
    MAX_BAL_BC::NUMBER(18,2)                AS MAX_BAL_BC,
    AVG_CUR_BAL::NUMBER(18,2)               AS AVG_CUR_BAL,
    DELINQ_2YRS::NUMBER                     AS DELINQ_2YRS,
    DELINQ_AMNT::NUMBER(18,2)               AS DELINQ_AMNT,
    NUM_BC_SATS::NUMBER                     AS NUM_BC_SATS,
    OPEN_ACC_6M::NUMBER                     AS OPEN_ACC_6M,
    OPEN_ACT_IL::NUMBER                     AS OPEN_ACT_IL,
    OPEN_IL_12M::NUMBER                     AS OPEN_IL_12M,
    OPEN_IL_24M::NUMBER                     AS OPEN_IL_24M,
    OPEN_RV_12M::NUMBER                     AS OPEN_RV_12M,
    OPEN_RV_24M::NUMBER                     AS OPEN_RV_24M,
    TOTAL_CU_TL::NUMBER                     AS TOTAL_CU_TL,
    INQ_LAST_12M::NUMBER                    AS INQ_LAST_12M,
    NUM_TL_30DPD::NUMBER                    AS NUM_TL_30DPD,
    NUM_OP_REV_TL::NUMBER                   AS NUM_OP_REV_TL,
    NUM_REV_ACCTS::NUMBER                   AS NUM_REV_ACCTS,
    ACC_NOW_DELINQ::NUMBER                  AS ACC_NOW_DELINQ,
    BC_OPEN_TO_BUY::NUMBER(18,2)            AS BC_OPEN_TO_BUY,
    FICO_RANGE_LOW::NUMBER                  AS FICO_RANGE_LOW,
    INQ_LAST_6MTHS::NUMBER                  AS INQ_LAST_6MTHS,
    MO_SIN_RCNT_TL::NUMBER                  AS MO_SIN_RCNT_TL,
    NUM_ACTV_BC_TL::NUMBER                  AS NUM_ACTV_BC_TL,
    PCT_TL_NVR_DLQ::NUMBER(5,2)             AS PCT_TL_NVR_DLQ,
    FICO_RANGE_HIGH::NUMBER                 AS FICO_RANGE_HIGH,
    NUM_ACTV_REV_TL::NUMBER                 AS NUM_ACTV_REV_TL,
    TRY_TO_DATE(EARLIEST_CR_LINE, 'MON-YYYY') AS EARLIEST_CR_LINE,
    NUM_TL_120DPD_2M::NUMBER                AS NUM_TL_120DPD_2M,
    PERCENT_BC_GT_75::NUMBER(5,2)           AS PERCENT_BC_GT_75,
    SEC_APP_MORT_ACC::NUMBER                AS SEC_APP_MORT_ACC,
    SEC_APP_OPEN_ACC::NUMBER                AS SEC_APP_OPEN_ACC,
    CREDIT_HISTORY_KEY::NUMBER              AS CREDIT_HISTORY_KEY,
    MO_SIN_OLD_IL_ACCT::NUMBER              AS MO_SIN_OLD_IL_ACCT,
    MTHS_SINCE_RCNT_IL::NUMBER              AS MTHS_SINCE_RCNT_IL,
    NUM_TL_90G_DPD_24M::NUMBER              AS NUM_TL_90G_DPD_24M,
    NUM_TL_OP_PAST_12M::NUMBER              AS NUM_TL_OP_PAST_12M,
    SEC_APP_REVOL_UTIL::NUMBER(10,2)        AS SEC_APP_REVOL_UTIL,
    _AB_SOURCE_FILE_URL::VARCHAR            AS _AB_SOURCE_FILE_URL,
    NUM_REV_TL_BAL_GT_0::NUMBER             AS NUM_REV_TL_BAL_GT_0,
    SEC_APP_OPEN_ACT_IL::NUMBER             AS SEC_APP_OPEN_ACT_IL,
    ACC_OPEN_PAST_24MTHS::NUMBER            AS ACC_OPEN_PAST_24MTHS,
    MO_SIN_OLD_REV_TL_OP::NUMBER            AS MO_SIN_OLD_REV_TL_OP,
    MTHS_SINCE_RECENT_BC::NUMBER            AS MTHS_SINCE_RECENT_BC,
    PUB_REC_BANKRUPTCIES::NUMBER            AS PUB_REC_BANKRUPTCIES,
    MO_SIN_RCNT_REV_TL_OP::NUMBER           AS MO_SIN_RCNT_REV_TL_OP,
    MTHS_SINCE_RECENT_INQ::NUMBER           AS MTHS_SINCE_RECENT_INQ,
    NUM_ACCTS_EVER_120_PD::NUMBER           AS NUM_ACCTS_EVER_120_PD,
    SEC_APP_NUM_REV_ACCTS::NUMBER           AS SEC_APP_NUM_REV_ACCTS,
    MTHS_SINCE_LAST_DELINQ::NUMBER          AS MTHS_SINCE_LAST_DELINQ,
    MTHS_SINCE_LAST_RECORD::NUMBER          AS MTHS_SINCE_LAST_RECORD,
    SEC_APP_FICO_RANGE_LOW::NUMBER          AS SEC_APP_FICO_RANGE_LOW,
    SEC_APP_INQ_LAST_6MTHS::NUMBER          AS SEC_APP_INQ_LAST_6MTHS,
    SEC_APP_FICO_RANGE_HIGH::NUMBER         AS SEC_APP_FICO_RANGE_HIGH,
    CHARGEOFF_WITHIN_12_MTHS::NUMBER        AS CHARGEOFF_WITHIN_12_MTHS,
    MTHS_SINCE_RECENT_BC_DLQ::NUMBER        AS MTHS_SINCE_RECENT_BC_DLQ,
    SEC_APP_EARLIEST_CR_LINE::VARCHAR       AS SEC_APP_EARLIEST_CR_LINE,
    COLLECTIONS_12_MTHS_EX_MED::NUMBER      AS COLLECTIONS_12_MTHS_EX_MED,
    MTHS_SINCE_LAST_MAJOR_DEROG::NUMBER     AS MTHS_SINCE_LAST_MAJOR_DEROG,
    _AB_SOURCE_FILE_LAST_MODIFIED::TIMESTAMP_NTZ AS _AB_SOURCE_FILE_LAST_MODIFIED,
    MTHS_SINCE_RECENT_REVOL_DELINQ::NUMBER  AS MTHS_SINCE_RECENT_REVOL_DELINQ,
    SEC_APP_CHARGEOFF_WITHIN_12_MTHS::NUMBER AS SEC_APP_CHARGEOFF_WITHIN_12_MTHS,
    SEC_APP_COLLECTIONS_12_MTHS_EX_MED::NUMBER AS SEC_APP_COLLECTIONS_12_MTHS_EX_MED

FROM raw_credithistory
